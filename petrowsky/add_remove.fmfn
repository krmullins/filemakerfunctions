/*
AddRemove( value ; valuelist )
RETURNS:  (string) The supplied list with the value either removed or concatenated 
*/

Let([ 
//------------------------- VARIABLES

_Exists = PatternCount ( ¶ & valuelist & ¶ ; ¶ & value & ¶ )

];
//------------------------- RESULT

Case (
  _Exists;
    MiddleValues ( Substitute ( "¶" & valuelist ; "¶" & value & "¶" ; "¶" ) ; 2 ; 1000000 );
  valuelist & value & "¶"
  )

)